<form id="formCreatePost" method="post" th:object="${createPost}" th:action="@{/post/create}"
      xmlns:th="http://www.w3.org/1999/xhtml">
    <div class="mt-3">
        <label for="title" class="form-label">Naslov</label>
        <input type="text" class="form-control" id="title" name="title" th:field="*{title}">
        <p class="text-danger mt-0" th:if="${#fields.hasErrors('title')}" th:errors="*{title}"></p>
    </div>
    <div class="mt-3">
        <label for="description" class="form-label">Opis</label>
        <textarea class="form-control" id="description" name="description" th:field="*{description}"></textarea>
        <p class="text-danger mt-0" th:if="${#fields.hasErrors('description')}" th:errors="*{description}"></p>
    </div>
    <div class="mt-3">
        <label for="condition" class="form-label">Stanje</label>
        <select class="form-select" id="condition" name="condition" th:field="*{condition}">
            <option value="NEW">Novo</option>
            <option value="SHORT_USED">Kratko korišteno</option>
            <option value="LONG_USED">Duže korišteno</option>
        </select>
    </div>
    <div class="mt-3">
        <label for="price" class="form-label">Cijena</label>
        <input type="number" step="0.01" min="0" value="0" class="form-control" id="price" name="price" th:field="*{price}">
        <p class="text-danger mt-0" th:if="${#fields.hasErrors('price')}" th:errors="*{price}"></p>
    </div>

    <div class="mt-3">
        <label for="images" class="form-label">Slike</label>
        <input class="form-control" type="file" id="images" accept="images/*" name="images" multiple th:field="*{images}"/>
    </div>

    <button class="btn btn-primary w-100 mt-3" type="submit">Napravi</button>
</form>

<script>
    const formCreatePost = document.getElementById('formCreatePost');

    formCreatePost.onsubmit = e => {
        e.preventDefault();
        fetch(formCreatePost.action, {method: 'post', body: new FormData(formCreatePost)})
            .then(result => {
                if (result.redirected) {
                    window.location.reload();
                    return null;
                }
                return result.text();
            })
            .then(html => {
                if (html != null) {
                    formCreatePost.innerHTML = html;
                }
            })
            .catch(err => console.log(err));
    }
</script>